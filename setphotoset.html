<p><strong><code>jzmn.setPhotoset</code></strong> is a javascript function for beautifully resizing images in a photoset, without cropping or aspect-ratio distortion, such that all images in a row are of the same height. <code>jzmn.setPhotoset</code> makes use of percentage widths, so that the photoset can work for all sizes, and can be resized without problem. [<a href="https://github.com/JZumun/jzmn.setPhotoset" target="_blank">Github</a>]</p>
<p>Like most of my coding experiments, it is encapsulated in the <code>jzmn</code> namespace. This largely means nothing.</p>
<h2>Basic Usage</h2>
<p>The general format of <code>jzmn.setPhotoset</code> is shown below:</p>
<pre><code>window.addEventListener("load",function() {
    jzmn.setPhotoset(<em>element,userOptions</em>);
});
</code></pre>
<p><em>element</em>refers to the element node (or nodelist of elements) that contains the photoset, while <em>userOptions</em> is an object containing customizable options for the function (more info below).</p>
<p><code>jzmn.setPhotoset</code> makes use of img.naturalWidth and naturalHeight to automatically get dimensional information from the images. Because of this, the function is best called inside a window load event handler. However, if the height and width attribute of the images are provided in the markup, <code>jzmn.setPhotoset</code> can be called outside an onload event handler in the following manner:</p>
<pre><code>jzmn.setPhotoset(<em>element,</em>{pData:true,<em> userOptions</em>});</code></pre>
<h3>The CSS</h3>
<p><code>jzmn.setPhotoset</code> only sets the widths of the elements in the photoset using javascript. The rest of the styling is delegated to CSS, by means of attaching classes to each photoset elements.</p>
<p><code>jzmn.setPhotoset</code> provides the following classes for styling hooks:</p>
<ul>
<li><code>photoset-item</code> - for all elements that are children of the photoset-container.</li>
<li><code>photoset-last-column</code> - for all photoset items that are the last item in their row.</li>
<li><code>photoset-last-row</code> - for all photoset items that are in the last row.</li>
</ul>
<p>The provided classes can then be utilized as in the following sample CSS (for more information, visit <em>set-photoset-example.css</em> in the github repository):</p>
<pre class="lang-css"><code>.photoset-item {
    display: block;
    float: left;
    margin: 5px;
    margin-left: 0;
    margin-top: 0;
}
.photoset-last-column {
    margin-right:0 !important;
}
.photoset-last-column + .photoset-item {
    clear:left;
}
.photoset-last-row {
    margin-bottom:0 !important;
}</code></pre>
<h3>Example</h3>
<p>Suppose you have a set of five images, which you want to lay out into 2 rows, with 2 images on the first row and the 3 on the second.</p>
<pre class="lang-html"><code>&lt;div class="photoset" id="#photoset1"&gt;
    &lt;img src="1.png" /&gt;
    &lt;img src="2.png" /&gt;
    &lt;img src="3.png" /&gt;
    &lt;img src="4.png" /&gt;
    &lt;img src="5.png" /&gt;
&lt;/div&gt;</code>
</pre>
<p>Without <code>jzmn.setPhotoset</code>, this set will look something like the following. Note that the following has been scaled by 50%, because at original scale, it was very tall.</p>
<div class="set-example" id="example1">
    <img src="https://41.media.tumblr.com/ca493b931aed8a348ecf4d768fe158ba/tumblr_ntl3gkXUhJ1qhqme0o9_1280.jpg" />
    <img src="https://40.media.tumblr.com/88c5926f7966818fccb3f8742bdf84c4/tumblr_ntl3gkXUhJ1qhqme0o1_1280.jpg" />
    <img src="https://40.media.tumblr.com/a302157bbca1674eefb2d18bc1b15c09/tumblr_ntl3gkXUhJ1qhqme0o2_1280.jpg" />
    <img src="https://40.media.tumblr.com/a10e1f69de529e8f04821a3208028184/tumblr_ntl3gkXUhJ1qhqme0o7_1280.jpg" />
    <img src="https://41.media.tumblr.com/4d5c8effb0288215c9c15d1f3c794738/tumblr_ntl3gkXUhJ1qhqme0o6_1280.jpg" />
</div>
<p>Applying <code>jzmn.setPhotoset</code>:</p>
<pre><code>var photoset = document.querySelector("#photoset1");
jzmn.setPhotoset(photoset,{layout:"23"});</code></pre>
<p>Now it would look like</p>
<div class="set-example" id="example2"><img src="https://41.media.tumblr.com/ca493b931aed8a348ecf4d768fe158ba/tumblr_ntl3gkXUhJ1qhqme0o9_1280.jpg" />
    <img src="https://40.media.tumblr.com/88c5926f7966818fccb3f8742bdf84c4/tumblr_ntl3gkXUhJ1qhqme0o1_1280.jpg" />
    <img src="https://40.media.tumblr.com/a302157bbca1674eefb2d18bc1b15c09/tumblr_ntl3gkXUhJ1qhqme0o2_1280.jpg" />
    <img src="https://40.media.tumblr.com/a10e1f69de529e8f04821a3208028184/tumblr_ntl3gkXUhJ1qhqme0o7_1280.jpg" />
    <img src="https://41.media.tumblr.com/4d5c8effb0288215c9c15d1f3c794738/tumblr_ntl3gkXUhJ1qhqme0o6_1280.jpg" /></div>
<h2>Multiple Photosets</h2>
<p>a single <code>jzmn.setPhotoset</code> function call is capable of serving multiple photosets with different layouts, as long as a <code>data-layout</code> attribute is specified per photoset:</p>
<pre class="lang-html"><code>&lt;div class="photoset" id="#photoset1" data-layout="23"&gt;
    &lt;img src="1.png" /&gt;
    &lt;img src="2.png" /&gt;
    &lt;img src="3.png" /&gt;
    &lt;img src="4.png" /&gt;
    &lt;img src="5.png" /&gt;
&lt;/div&gt;
&lt;div class="photoset" id="#photoset2" data-layout="121" &gt;
    &lt;img src="6.png" /&gt;
    &lt;img src="7.png" /&gt;
    &lt;img src="8.png" /&gt;
    &lt;img src="9.png" /&gt;
&lt;/div&gt;</code></pre>
<p>In this case, the javascript code is:</p>
<pre><code>var photosets = document.querySelectorAll(".photoset");
jzmn.setPhotoset(photosets);</code></pre>
<p>If <code>data-layout</code>&nbsp;is not specified for an element in this case, jzmn.setPhotoset won&rsquo;t do anything to that set.</p>
<div class="set-example" id="example3">
<div class="photoset" data-layout="23">
    <img src="https://41.media.tumblr.com/ca493b931aed8a348ecf4d768fe158ba/tumblr_ntl3gkXUhJ1qhqme0o9_1280.jpg" />
    <img src="https://40.media.tumblr.com/88c5926f7966818fccb3f8742bdf84c4/tumblr_ntl3gkXUhJ1qhqme0o1_1280.jpg" />
    <img src="https://40.media.tumblr.com/a302157bbca1674eefb2d18bc1b15c09/tumblr_ntl3gkXUhJ1qhqme0o2_1280.jpg" />
    <img src="https://40.media.tumblr.com/a10e1f69de529e8f04821a3208028184/tumblr_ntl3gkXUhJ1qhqme0o7_1280.jpg" />
    <img src="https://41.media.tumblr.com/4d5c8effb0288215c9c15d1f3c794738/tumblr_ntl3gkXUhJ1qhqme0o6_1280.jpg" />
    </div>
<div class="photoset" data-layout="121"><img src="https://40.media.tumblr.com/8dfa2986674e33563e1caac48efceb89/tumblr_ntl3gkXUhJ1qhqme0o4_1280.jpg" /><img src="https://41.media.tumblr.com/115e9ab4739513722e919344c775813d/tumblr_ntl3gkXUhJ1qhqme0o5_1280.jpg" /><img src="https://41.media.tumblr.com/8b1419800b3fa4d9cfde6fffe47ca9ae/tumblr_ntl3gkXUhJ1qhqme0o3_1280.jpg" /><img src="https://40.media.tumblr.com/a10e1f69de529e8f04821a3208028184/tumblr_ntl3gkXUhJ1qhqme0o7_1280.jpg" /></div>
</div>
<h2>A Photoset of&hellip; <em>not</em> Photos?</h2>
<p><code>jzmn.setPhotoset</code> uses img.naturalWidth and naturalHeight to automatically get dimensional information from the images. If the children of the element is not an img (or if the browser does not support naturalWidth/Height), it might be necessary to explicitly define the dimensions on these children. This could be the case if the images are wrapped in anchor tags.</p>
<p>This is done by defining width and height attributes per child, and setting <code>pData</code> to true in <em>userOptions</em>. Alternatively, user-defined attributes can also be used (such as <em>data-height</em> and <em>data-width</em>, for example, on elements where <em>width</em> and <em>height</em> attributes are not semantically appropriate), as long as the <code>jzmn.setPhotoset</code> function call sets <code>childHeight</code> and <code>childWidth</code> in <em>userOptions</em> to the name of these attributes.</p>
<p>For the following example markup:</p>
<pre class="lang-html"><code>&lt;div class="photoset" id="#photoset1" data-layout="12" &gt;
    &lt;a href="1.png" data-height="200" data-width"200"&gt;
        &lt;img src="1.png" /&gt;
    &lt;/a&gt;
    &lt;a href="2.png" data-height="150" data-width"300"&gt;
        &lt;img src="2.png" /&gt;
    &lt;/a&gt;
    &lt;a href="1.png" data-height="200" data-width"150"&gt;
        &lt;img src="1.png" /&gt;
    &lt;/a&gt;
&lt;/div&gt;</code></pre>
<p>Using the following javascript code will work:</p>
<pre><code>var photoset = document.querySelector("#photoset1")
jzmn.setPhotoset(photoset,{pData:true, childHeight:'data-height', childWidth: 'data-width'});</code></pre>
<div class="set-example" id="example4" data-layout="12"><a href="#" data-width="3264" data-height="2448"><img src="https://40.media.tumblr.com/a10e1f69de529e8f04821a3208028184/tumblr_ntl3gkXUhJ1qhqme0o7_1280.jpg" /></a> <a href="#" data-width="1050" data-height="700"><img src="https://40.media.tumblr.com/88c5926f7966818fccb3f8742bdf84c4/tumblr_ntl3gkXUhJ1qhqme0o1_1280.jpg" /></a> <a href="#" data-width="1050" data-height="1575"><img src="https://40.media.tumblr.com/a302157bbca1674eefb2d18bc1b15c09/tumblr_ntl3gkXUhJ1qhqme0o2_1280.jpg" /></a></div>
<h2>Gutters</h2>
<p>You can set gutters using the following syntax:</p>
<pre><code>jzmn.setPhotoset(<em>photoset</em>,{gutter:<em>gutterWidth</em>});</code></pre>
<p>where <em>gutterWidth</em> is a string representing the width of the gutter. It can be in px or em, or in fact any expression valid within a css <code>calc()</code> function. This is because, when calculating for the width of photoset items with gutters, <code>calc()</code> is used. If the browser does not support <code>calc()</code>, then the default, percentage only width is still provided.</p>
<p>Note, however, that <code>jzmn.setPhotoset</code> only uses the value passed to it to calculate the widths of the images. To actually set a gutter, one must set the photoset-item&rsquo;s margin using css:</p>
<pre class="lang-css">.photoset-item { 
    margin-top: <em>gutterWidth</em>; 
    margin-left: <em>gutterWidth</em>; 
}</pre>
<p>Here is what our first photoset would look like if the pictures had margins of 5px, using the following javascript code:</p>
<pre><code>var photoset = document.querySelector("#example5");
jzmn.setPhotoset(photoset,{gutter:"5px"});</code></pre>
<div class="set-example" id="example5"><img src="https://40.media.tumblr.com/a10e1f69de529e8f04821a3208028184/tumblr_ntl3gkXUhJ1qhqme0o7_1280.jpg" /><img src="https://40.media.tumblr.com/88c5926f7966818fccb3f8742bdf84c4/tumblr_ntl3gkXUhJ1qhqme0o1_1280.jpg" /><img src="https://40.media.tumblr.com/a302157bbca1674eefb2d18bc1b15c09/tumblr_ntl3gkXUhJ1qhqme0o2_1280.jpg" /><img src="https://41.media.tumblr.com/ca493b931aed8a348ecf4d768fe158ba/tumblr_ntl3gkXUhJ1qhqme0o9_1280.jpg" /><img src="https://41.media.tumblr.com/4d5c8effb0288215c9c15d1f3c794738/tumblr_ntl3gkXUhJ1qhqme0o6_1280.jpg" /></div>
<h2>Known Issues</h2>
<p><code>jzmn.setPhotoset</code>&rsquo;s calculated widths may not be accurate if the images have paddings or borders.</p>
<script src="http://static.tumblr.com/wvoc5tm/i6Dnsgxc8/jzmn.setphotoset-min.js" type="text/javascript">// <![CDATA[

// ]]></script>
<script type="text/javascript">// <![CDATA[
var photosets = ["#example2","#example3 .photoset","#example5"];
    var photoOpts = [{layout:"23"},{},{layout:"23",gutter:"5px"}];

    photosets.forEach(function(n,i){
        var els = document.querySelectorAll(n);
        Array.prototype.forEach.call(els,function(el,j) {
            var imgs = el.querySelectorAll("img");
            var goal = imgs.length;
            var loaded = 0;
            el.addEventListener("load",function(e){
                if (e.target && e.target.nodeName==="IMG") loaded += 1;
                if (loaded === goal) jzmn.setPhotoset(el,photoOpts[i]);
            },true);
        });
    });

    jzmn.setPhotoset(document.querySelectorAll("#example4"), {
        pData: true,
        childHeight: 'data-height',
        childWidth: 'data-width'
    });
// ]]></script>