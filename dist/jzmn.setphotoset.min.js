!function(a){if("object"==typeof exports&&"undefined"!=typeof module)module.exports=a();else if("function"==typeof define&&define.amd)define([],a);else{var b;b="undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:this,b.setPhotoset=a()}}(function(){return function a(b,c,d){function e(g,h){if(!c[g]){if(!b[g]){var i="function"==typeof require&&require;if(!h&&i)return i(g,!0);if(f)return f(g,!0);var j=new Error("Cannot find module '"+g+"'");throw j.code="MODULE_NOT_FOUND",j}var k=c[g]={exports:{}};b[g][0].call(k.exports,function(a){var c=b[g][1][a];return e(c?c:a)},k,k.exports,a,b,c,d)}return c[g].exports}for(var f="function"==typeof require&&require,g=0;g<d.length;g++)e(d[g]);return e}({1:[function(a,b,c){"use strict";function d(a){if(Array.isArray(a)){for(var b=0,c=Array(a.length);b<a.length;b++)c[b]=a[b];return c}return Array.from(a)}var e=function(a){return a.toString()===a},f=Array.isArray,g=function(){},h=function(a){return parseInt(a,10)},i=function(a){return"["===a.charAt(0)?a.replace(/\[([0-9,]*)\]/,"$1").split(",").map(h):a.split("").map(h)},j=function(a){return f(a)?a:e(a)?i(a):[]},k=function(a){return a&&a+(e(a)?"":"px")},l=function(){return Math.floor(1e5*Math.random()+1).toString()},m=function(a){return a?e(a)?document.querySelectorAll(a):a.nodeType?[a]:a.length?a:void 0:[]},n=function(){var a=document.createElement("style");return a.setAttribute("type","text/css"),a.setAttribute("id","jzmn-setphotoset-styles"),a.appendChild(document.createTextNode("")),document.head.appendChild(a),[".photoset-container:after {content:'';display:table;clear:both;}",".photoset-item { display:block;float:left;margin:0;height:auto;}",".photoset-last-column {margin-right:0;}",".photoset-first-column {clear:left}",".photoset-last-row {margin-bottom:0;}"].forEach(function(b){return a.sheet.insertRule(b,a.sheet.cssRules.length)}),a},o=new Set,p=document.querySelector("#jzmn-setphotoset-styles"),q=function(a){var b=a.grouping,c=a.gutter;p||(p=n()),c&&!o.has(b)&&(o.add(b),[".photoset-"+b+" .photoset-item:not(.photoset-last-column) { margin-right: calc("+c+"); }",".photoset-"+b+" .photoset-item:not(.photoset-last-row) { margin-bottom: calc("+c+"); }"].forEach(function(a){return p.sheet.insertRule(a,p.sheet.cssRules.length)}))},r=function(a,b){var c=b.immediate,d=b.childItem;return new Promise(function(b,e){(c||"img"!=d)&&b(a);var f=function(c){c.target&&c.target.matches(d)&&0===--h&&b(a)},g=Array.from(a.querySelectorAll(d)),h=g.length;g.forEach(function(c,d){c.complete&&0===--h&&b(a)}),a.addEventListener("load",f,!0),a.addEventListener("error",f,!0)})},s=function(a){var b=a.layout,c=a.gutter,e=a.childItem,f=a.childHeight,g=a.childWidth;return function(a){var h=Array.from(a.querySelectorAll(e)),i=b.length,j=[],k=[],l=[],m=[];return b.reduce(function(a,b,c,e){var n=a+b,o=h.slice(a,n),p=o.length,q=o.map(function(a,b){0===b&&l.push(a),b===p-1&&j.push(a),c===i-1&&k.push(a);var d=a.matches("img")?a.naturalHeight/a.naturalWidth:parseInt(a.getAttribute(f))/parseInt(a.getAttribute(g));return Number.isNaN(d)?1:d}),r=0,s=q.map(function(a,b){var c=0;return c=0==b?r=100/q.reduce(function(b,c){return b+a/c},0):r*(q[0]/a),{width:c,numItems:p}});return m.push.apply(m,d(s)),n},0),m.forEach(function(a,b){var d=a.width,e=a.numItems,f=h[b];f.classList.add("photoset-item"),f.classList.remove("photoset-last-column","photoset-last-row","photoset-first-column"),f.setAttribute("style","width: "+d+"%;"+(c?"width: calc("+d/100+"*(100% - "+(e-1)+"*("+c+")));":""))}),j.forEach(function(a){return a.classList.add("photoset-last-column")}),k.forEach(function(a){return a.classList.add("photoset-last-row")}),l.forEach(function(a){return a.classList.add("photoset-first-column")}),a.classList.remove("photoset-loading"),a}},t=function(a){var b=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},c=b.layout,d=void 0===c?null:c,e=b.immediate,f=void 0!==e&&e,h=b.childItem,i=void 0===h?"img":h,n=b.childHeight,o=void 0===n?"height":n,p=b.childWidth,t=void 0===p?"width":p,u=b.gutter,v=void 0===u?0:u,w=b.callback,x=void 0===w?g:w,y=b.createSheet,z=void 0===y||y,A=b.layoutAttribute,B=void 0===A?"data-layout":A,C=arguments.length>2&&void 0!==arguments[2]?arguments[2]:l();a=m(a),v=k(v),z&&q({grouping:C,gutter:v});var D=!0,E=!1,F=void 0;try{for(var G,H=a[Symbol.iterator]();!(D=(G=H.next()).done);D=!0){var I=G.value;I.classList.add("photoset-loading","photoset-container","photoset-"+C),d=j(d||I.getAttribute(B)),r(I,{immediate:f,childItem:i}).then(s({layout:d,gutter:v,childItem:i,childHeight:o,childWidth:t})).then(x)}}catch(a){E=!0,F=a}finally{try{!D&&H.return&&H.return()}finally{if(E)throw F}}return a};b.exports=t},{}]},{},[1])(1)});